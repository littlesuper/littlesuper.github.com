<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[ITman.cc]]></title>
  <subtitle><![CDATA[关注互联网发展...]]></subtitle>
  <link href="http://itman.cc/atom.xml" rel="self"/>
  <link href="http://itman.cc"/>
  <updated>2013-11-27T14:36:13.454Z</updated>
  <id>http://itman.cc/</id>
  <author>
    <name><![CDATA[L.S]]></name>
    <email><![CDATA[littlesuper@gmail.com]]></email>
  </author>
  <generator uri="http://zespia.tw/hexo">Hexo</generator>
  <entry>
    <title type="html"><![CDATA[Rsync 的配置与使用]]></title>
    <link href="http://itman.cc/2013/11/27/rsync/"/>
    <id>http://itman.cc/2013/11/27/rsync/</id>
    <published>2013-11-27T10:05:55.000Z</published>
    <updated>2013-11-27T14:36:08.000Z</updated>
    <content type="html"><![CDATA[<h3><strong>一、简介</strong></h3>
<p>Rsync 是一个远程数据同步工具，可通过 LAN/WAN 快速同步多台主机间的文件。 Rsync 本来是用以取代 rcp 的一个工具，它当前由  rsync.samba.org 维护。 Rsync 使用所谓的“ Rsync 演算法 ”来使本地和远程两个主机之间的文件达到同步，这个算法只传送两个文件的不同部分，而不是每次都整份传送，因此速度相当快。运行 Rsync server 的机器也叫 backup server ，一个 Rsync server 可同时备份多个 client 的数据；也可以多个 Rsync server 备份一个 client 的数据。</p>
<p>Rsync 可以搭配 rsh 或 ssh 甚至使用 daemon 模式。 Rsync server 会打开一个 873 的服务通道 (port) ，等待对方 Rsync 连接。连接时， Rsync server 会检查口令是否相符，若通过口令查核，则可以开始进行文件传输。第一次连通完成时，会把整份文件传输一次，下一次就只传送二个文件之间不同的部份。</p>
<p>Rsync 支持大多数的类 Unix 系统，无论是 Linux 、 Solaris 还是 BSD 上都经过了良好的测试。此外，它在 windows 平台下也有相应的版本，比较知名的有 cwRsync 和 Sync2NAS 。</p>
<a id="more"></a>

<h4><strong>Rsync 的基本特点如下：</strong></h4>
<ul>
<li>可以镜像保存整个目录树和文件系统</li>
<li>可以很容易做到保持原来文件的权限、时间、软硬链接等</li>
<li>无须特殊权限即可安装</li>
<li>优化的流程，文件传输效率高</li>
<li>可以使用rcp 、 ssh等方式来传输文件，当然也可以通过直接的socket 连接</li>
<li>支持匿名传输</li>
</ul>
<h4><strong>核心算法介绍：</strong></h4>
<p>假定在名为α和β的两台计算机之间同步相似的文件A与B，其中α对文件A拥有访问权，β对文件B拥有访问权。并且假定主机α与β之间的网络带宽很小。那么rsync算法将通过下面的五个步骤来完成：</p>
<ul>
<li><p>β将文件B分割成一组不重叠的固定大小为S字节的数据块。最后一块可能会比S小。</p>
</li>
<li><p>β对每一个分割好的数据块执行两种校验：一种是32位的滚动弱校验，另一种是128位的MD4强校验。</p>
</li>
<li><p>β将这些校验结果发给α。</p>
</li>
<li><p>α通过搜索文件A的所有大小为S的数据块 ( 偏移量可以任选，不一定非要是S的倍数) ，来寻找与文件B的某一块有着相同的弱校验码和强校验码的数据块。这项工作可以借助滚动校验的特性很快完成。</p>
</li>
<li><p>α发给β一串指令来生成文件A在β上的备份。这里的每一条指令要么是对文件B经拥有某一个数据块而不须重传的证明，要么是一个数据块，这个数据块肯定是没有与文件B的任何一个数据块匹配上的。</p>
</li>
</ul>
<h4><strong>命令：</strong></h4>
<p>rsync 的命令格式可以为以下六种：</p>
<pre><code>rsync [OPTION]<span class="keyword">...</span> SRC DEST
rsync [OPTION]<span class="keyword">...</span> SRC [USER@]HOST:DEST
rsync [OPTION]<span class="keyword">...</span> [USER@]HOST:SRC DEST
rsync [OPTION]<span class="keyword">...</span> [USER@]HOST::SRC DEST
rsync [OPTION]<span class="keyword">...</span> SRC [USER@]HOST::DEST
rsync [OPTION]<span class="keyword">...</span> rsync://[USER@]HOST[:PORT]/SRC [DEST]</code></pre>
<p>对应于以上六种命令格式， rsync 有六种不同的工作模式：</p>
<ol>
<li><p>拷贝本地文件。当 SRC 和 DES 路径信息都不包含有单个冒号 “:” 分隔符时就启动这种工作模式。</p>
</li>
<li><p>使用一个远程 shell 程序 ( 如 rsh 、 ssh) 来实现将本地机器的内容拷贝到远程机器。当 DST 路径地址包含单个冒号 “:” 分隔符时启动该模式。</p>
</li>
<li><p>使用一个远程 shell 程序 ( 如 rsh 、 ssh) 来实现将远程机器的内容拷贝到本地机器。当 SRC 地址路径包含单个冒号 “:” 分隔符时启动该模式。</p>
</li>
<li><p>从远程 rsync 服务器中拷贝文件到本地机。当 SRC 路径信息包含 “::” 分隔符时启动该模式。</p>
</li>
<li><p>从本地机器拷贝文件到远程 rsync 服务器中。当 DST 路径信息包含 “::” 分隔符时启动该模式。</p>
</li>
<li><p>列远程机的文件列表。这类似于 rsync 传输，不过只要在命令中省略掉本地机信息即可。</p>
</li>
</ol>
<h3>二、配置</h3>
<p>配置/etc/rsyncd.conf，一般情况下安装了rsync不会自动创建rsyncd.conf，配置如下</p>
<pre><code><span class="comment"># Rsync configuration file</span>
secrets <span class="type">file</span> = /etc/rsyncd.secrets <span class="comment">#认证用户名和密码文件的名称和位置</span>
motd <span class="type">file</span> = /etc/rsyncd.motd <span class="comment">#欢迎文件，可自己编辑</span>
<span class="command">read</span>&gt;<span class="type">list</span> = yes
uid = root
gid = root
use chroot = no
max connections = <span class="number">5</span>
<span class="command">log</span> <span class="type">file</span> = /var/<span class="command">log</span>/rsyncd.<span class="command">log</span>
pid <span class="type">file</span> = /var/<span class="command">run</span>/rsyncd.pid
lock <span class="type">file</span> = /var/<span class="command">run</span>/rsync.lock
<span class="comment"># Remote sync configuration module</span>
[testsync]
comment = testsync directory
path = /root
auth users = rsync</code></pre>
<p>生成密码文件</p>
<pre><code><span class="title">echo</span> <span class="string">"rsync:password"</span> &gt;&gt; /etc/rsyncd.secrets
<span class="title">chmod</span> <span class="number">600</span> /etc/rsyncd.secrets </code></pre>
<p>启动rsync<br>rsync —daemon</p>
<p>从客户端同步文件<br>rsync -vzrtopg —progress rsync@192.168.190.1::testsync /root<br>rsync -vzrtopg —delete —progress rsync@192.168.190.1::testsync /root</p>
<p>增加—delete参数会把原有chjq目录下的文件删除以保持客户端和服务器端文件系统完全一致，慎用!</p>
]]></content>
    <category scheme="http://itman.cc/tags/rsync/" term="rsync"/>
    <category scheme="http://itman.cc/categories/Unix/Linux/" term="Unix/Linux"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[Oracle 12c 结构图]]></title>
    <link href="http://itman.cc/2013/11/26/oracle-12c-architecture/"/>
    <id>http://itman.cc/2013/11/26/oracle-12c-architecture/</id>
    <published>2013-11-26T05:42:32.000Z</published>
    <updated>2013-11-26T05:55:16.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://farm8.staticflickr.com/7427/11062104135_4371d6a282_z.jpg" alt=""><br><a id="more"></a></p>
<h3>Windows</h3>
<p><a href="http://farm6.staticflickr.com/5498/11062113575_9e17a99946_o.jpg" target="_blank">1280*800</a></p>
<p><a href="http://farm3.staticflickr.com/2820/11062204836_3b7ea9e1b2_o.jpg" target="_blank">1366*768</a></p>
<p><a href="http://farm8.staticflickr.com/7397/11062099825_11978b58cc_o.jpg" target="_blank">1920*1060</a></p>
<p><a href="http://farm6.staticflickr.com/5536/11062213154_93e48bc25b_o.jpg" target="_blank">2560*1600</a></p>
<h3>Mac</h3>
<p><a href="http://farm3.staticflickr.com/2873/11062227424_c3e530a7a3_o.jpg" target="_blank">1280*800</a></p>
<p><a href="http://farm6.staticflickr.com/5491/11062108395_da43726154_o.jpg" target="_blank">1366*768</a></p>
<p><a href="http://farm6.staticflickr.com/5474/11062106795_f83e319642_o.jpg" target="_blank">1920*1080</a></p>
<p><a href="http://farm8.staticflickr.com/7427/11062104135_a999e880f9_o.jpg" target="_blank">2560*1600</a></p>
]]></content>
    <category scheme="http://itman.cc/tags/oracle/" term="oracle"/>
    <category scheme="http://itman.cc/categories/Database/" term="Database"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[Sublime Text 快捷键]]></title>
    <link href="http://itman.cc/2013/11/24/sublimetext-shortcut/"/>
    <id>http://itman.cc/2013/11/24/sublimetext-shortcut/</id>
    <published>2013-11-23T16:00:49.000Z</published>
    <updated>2013-11-23T16:02:11.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://farm3.staticflickr.com/2893/11011210035_060597c5e8_o.png" alt=""></p>
<p>如果说Notepad++是一款不错Code神器，那么Sublime Text应当称得上是神器滴哥。Sublime Text最大的优点就是跨平台，Mac和Windows均可完美使用；其次是强大的插件支持，几乎无所不能。<br><a id="more"></a></p>
<p><img src="http://farm8.staticflickr.com/7428/11011388073_ef0bd5be2a_z.jpg" alt=""></p>
<p>Sublime Text快捷键：</p>
<ul>
<li>Ctrl+Shift+P：打开命令面板</li>
<li>Ctrl+P：搜索项目中的文件</li>
<li>Ctrl+G：跳转到第几行</li>
<li>Ctrl+W：关闭当前打开文件</li>
<li>Ctrl+Shift+W：关闭所有打开文件</li>
<li>Ctrl+Shift+V：粘贴并格式化</li>
<li>Ctrl+D：选择单词，重复可增加选择下一个相同的单词</li>
<li>Ctrl+L：选择行，重复可依次增加选择下一行</li>
<li>Ctrl+Shift+L：选择多行</li>
<li>Ctrl+Shift+Enter：在当前行前插入新行</li>
<li>Ctrl+X：删除当前行</li>
<li>Ctrl+M：跳转到对应括号</li>
<li>Ctrl+U：软撤销，撤销光标位置</li>
<li>Ctrl+J：选择标签内容</li>
<li>Ctrl+F：查找内容</li>
<li>Ctrl+Shift+F：查找并替换</li>
<li>Ctrl+H：替换</li>
<li>Ctrl+R：前往 method</li>
<li>Ctrl+N：新建窗口</li>
<li>Ctrl+K+B：开关侧栏</li>
<li>Ctrl+Shift+M：选中当前括号内容，重复可选着括号本身</li>
<li>Ctrl+F2：设置/删除标记</li>
<li>Ctrl+/：注释当前行</li>
<li>Ctrl+Shift+/：当前位置插入注释</li>
<li>Ctrl+Alt+/：块注释，并Focus到首行，写注释说明用的</li>
<li>Ctrl+Shift+A：选择当前标签前后，修改标签用的</li>
<li>F11：全屏</li>
<li>Shift+F11：全屏免打扰模式，只编辑当前文件</li>
<li>Alt+F3：选择所有相同的词</li>
<li>Alt+.：闭合标签</li>
<li>Alt+Shift+数字：分屏显示</li>
<li>Alt+数字：切换打开第N个文件</li>
<li>Shift+右键拖动：光标多不，用来更改或插入列内容</li>
<li>鼠标的前进后退键可切换Tab文件</li>
<li>按Ctrl，依次点击或选取，可需要编辑的多个位置</li>
<li>按Ctrl+Shift+上下键，可替换行</li>
</ul>
<p>相关阅读：</p>
<ul>
<li><p><a href="http://www.daqianduan.com/4314.html" target="_blank">大前端推荐使用的前端开发工具</a></p>
</li>
<li><p><a href="http://www.daqianduan.com/4820.html" target="_blank">Sublime Text 使用介绍、全套快捷键及插件推荐</a></p>
</li>
</ul>
]]></content>
    <category scheme="http://itman.cc/tags/sublime text/" term="sublime text"/>
    <category scheme="http://itman.cc/categories/Geek/" term="Geek"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[Fixing Bazaar for Mac OS X]]></title>
    <link href="http://itman.cc/2013/11/12/fixing-bazaar-for-mac-os-x/"/>
    <id>http://itman.cc/2013/11/12/fixing-bazaar-for-mac-os-x/</id>
    <published>2013-11-12T14:43:21.000Z</published>
    <updated>2013-11-12T14:55:45.000Z</updated>
    <content type="html"><![CDATA[<p>When upgrading to Lion, if you try to run bzr, you’ll get an error:</p>
<pre><code>$ bzr whoami
bzr: ERROR: Couldn't import bzrlib <span class="keyword">and</span> dependencies.
Please check <span class="keyword">the</span> directory containing bzrlib <span class="keyword">is</span> <span class="function_start"><span class="keyword">on</span> <span class="title">your</span></span> PYTHONPATH.

Traceback (most recent call <span class="keyword">last</span>):
  File <span class="string">"/usr/local/bin/bzr"</span>, line <span class="number">102</span>, <span class="keyword">in</span> &lt;module&gt;
  import bzrlib
ImportError: No module named bzrlib</code></pre>
<p>It seems to be caused by Lion’s switch to python 2.7 as default, while bazaar installs on python 2.6.</p>
<p>Edit the file <code>/usr/local/bin/bzr</code> (with <code>sudo</code>) and complete the first line:</p>
<pre><code><span class="shebang">#!/usr/bin/python</span></code></pre>
<p>to</p>
<pre><code><span class="shebang">#!/usr/bin/python2.6</span></code></pre>
<p>and save, that should do the trick.</p>
<pre><code>$ bzr whoami
Name Surname <span class="tag">&lt;<span class="title">name@example.com</span>&gt;</span></code></pre>
]]></content>
    <category scheme="http://itman.cc/tags/Mac OS X/" term="Mac OS X"/>
    <category scheme="http://itman.cc/categories/Unix/Linux/" term="Unix/Linux"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[如何去掉优酷广告]]></title>
    <link href="http://itman.cc/2013/11/08/how-to-remove-youku-ad/"/>
    <id>http://itman.cc/2013/11/08/how-to-remove-youku-ad/</id>
    <published>2013-11-08T00:46:50.000Z</published>
    <updated>2013-11-09T15:22:49.000Z</updated>
    <content type="html"><![CDATA[<p>从道德上我一直不认同去掉视频网站广告的做法，毕竟这是他们主要收入来源。但国内视频网站得广告质量真的不堪入目，真心希望他们学学Youtube，让用户欣赏你的广告，而不是被你广告所强奸。</p>
<p>增加以下内容到hosts文件即可：</p>
<pre><code><span class="preprocessor">#优酷 </span>
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> atm<span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> fvid<span class="variable">.atm</span><span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> html<span class="variable">.atm</span><span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> valb<span class="variable">.atm</span><span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> valf<span class="variable">.atm</span><span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> valo<span class="variable">.atm</span><span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> valp<span class="variable">.atm</span><span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> Lstat<span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> speed<span class="variable">.lstat</span><span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> urchin<span class="variable">.lstat</span><span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> stat<span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="keyword">static</span><span class="variable">.lstat</span><span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> valc<span class="variable">.atm</span><span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> vid<span class="variable">.atm</span><span class="variable">.youku</span><span class="variable">.com</span> 
<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> walp<span class="variable">.atm</span><span class="variable">.youku</span><span class="variable">.com</span></code></pre>
]]></content>
    <category scheme="http://itman.cc/categories/Geek/" term="Geek"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[CentOS 下安装 Git]]></title>
    <link href="http://itman.cc/2013/11/06/centos-install-git/"/>
    <id>http://itman.cc/2013/11/06/centos-install-git/</id>
    <published>2013-11-06T05:04:42.000Z</published>
    <updated>2013-11-06T05:09:05.000Z</updated>
    <content type="html"><![CDATA[<p>现在都流行Git分布式版本控制系统，但CentOS无法直接通过yum安装，一大遗憾。手工安装步骤如下：</p>
<p>1、首先安装Git依赖的一些包.</p>
<pre><code><span class="comment">yum</span> <span class="comment">install</span> <span class="literal">-</span><span class="comment">y</span> <span class="comment">zlib</span>-<span class="comment">devel</span>
<span class="comment">yum</span> <span class="comment">install</span> <span class="literal">-</span><span class="comment">y</span> <span class="comment">openssl</span>-<span class="comment">devel</span>
<span class="comment">yum</span> <span class="comment">install</span> <span class="literal">-</span><span class="comment">y</span> <span class="comment">perl</span>
<span class="comment">yum</span> <span class="comment">install</span> <span class="literal">-</span><span class="comment">y</span> <span class="comment">cpio</span>
<span class="comment">yum</span> <span class="comment">install</span> <span class="literal">-</span><span class="comment">y</span> <span class="comment">expat</span>-<span class="comment">devel</span>
<span class="comment">yum</span> <span class="comment">install</span> <span class="literal">-</span><span class="comment">y</span> <span class="comment">gettext</span>-<span class="comment">devel</span>
<span class="comment">yum</span> <span class="comment">install</span> <span class="literal">-</span><span class="comment">y</span> <span class="comment">curl</code></pre>
<p>2、下载Git并安装它</p>
<pre><code><span class="title">wget</span> http://www.codemonkey.org.uk/projects/git-snapshots/git/git-latest.tar.gz
<span class="title">tar</span> xzvf git-latest.tar.gz
<span class="title">cd</span> git-{date}
<span class="title">autoconf</span>
./configure <span class="comment">--with-curl</span>
<span class="title">make</span>
<span class="title">make</span> install</code></pre>
]]></content>
    <category scheme="http://itman.cc/tags/git/" term="git"/>
    <category scheme="http://itman.cc/categories/Unix/Linux/" term="Unix/Linux"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[CGO Compilation for Mac OS X 10.9 Mavericks]]></title>
    <link href="http://itman.cc/2013/11/06/cgo-compilation-for-mavericks/"/>
    <id>http://itman.cc/2013/11/06/cgo-compilation-for-mavericks/</id>
    <published>2013-11-06T04:54:43.000Z</published>
    <updated>2013-11-12T14:55:52.000Z</updated>
    <content type="html"><![CDATA[<p>After upgrade to Mac OSX 10.9 you Cgo package will not be compiled successfully if you use the default <strong>clang</strong> compiler. For example, if you install gozmq on Mavericks you’ll get following error:</p>
<pre><code><span class="char">$ </span>go get -tags zmq_3_x github.com/alecthomas/gozmq

<span class="method">clang:</span> <span class="method">error:</span> argument unused during <span class="method">compilation:</span> <span class="string">'-fno-eliminate-unused-debug-types'</span></code></pre>
<p>I tried apple-gcc4.2 installed from homebrew but also failed:</p>
<pre><code><span class="char">$ </span><span class="class">GCC</span>=gcc-<span class="number">4.2</span> go get -tags zmq_3_x github.com/alecthomas/gozmq

<span class="method">clang:</span> <span class="method">warning:</span> argument unused during <span class="method">compilation:</span> <span class="string">'-pthread'</span>

<span class="method">clang:</span> <span class="method">error:</span> no such file or <span class="method">directory:</span> <span class="string">'libgcc.a'</span></code></pre>
<p>The solution is to download and install pre-built gcc package <a href="https://github.com/downloads/kennethreitz/osx-gcc-installer/GCC-10.7-v2.pkg" target="_blank">GCC-10.7-v2.pkg</a> from <a href="https://github.com/kennethreitz/osx-gcc-installer" target="_blank">osx-gcc-installer</a>. Then you can install the GO package as below:</p>
<pre><code>$ GCC=gcc-<span class="number">4.2</span> go <span class="keyword">get</span> -tags zmq_3_x github.com/alecthomas/gozmq</code></pre>
<p>It works for other Cgo package like goejdb as well.</p>
<p>Good luck and have fun!</p>
<p>转自：<a href="http://vitecho.com/" target="_blank">http://vitecho.com/</a></p>
]]></content>
    <category scheme="http://itman.cc/tags/Mac OS X/" term="Mac OS X"/>
    <category scheme="http://itman.cc/categories/Unix/Linux/" term="Unix/Linux"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[MySQL 导入数据方法]]></title>
    <link href="http://itman.cc/2013/11/03/mysql-import-data/"/>
    <id>http://itman.cc/2013/11/03/mysql-import-data/</id>
    <published>2013-11-03T06:39:19.000Z</published>
    <updated>2013-11-04T13:20:13.000Z</updated>
    <content type="html"><![CDATA[<p>从MsSQL导入数据到MySQL，操作方法如下：<br>1、MsSQL导出成TXT（原编码为GBK），MySQL新表是UTF8，使用iconv命令转换编码</p>
<pre><code><span class="title">iconv</span> -f <span class="type">GBK</span> -t <span class="type">UTF</span>-<span class="number">8</span> /<span class="type">Users</span>/itman/<span class="import"><span class="keyword">import</span>.txt &gt; import_utf8.txt</span></code></pre>
<p>2、创建MySQL数据库的数据表<br>3、这里说明一下，import.txt 每列使用的是逗号分隔，导入命令如下：</p>
<pre><code><span class="operator"><span class="keyword">load</span> data <span class="keyword">local</span> infile <span class="string">'/Users/itman/import_utf8.txt'</span> <span class="keyword">into</span> <span class="keyword">table</span> table_sample fields terminated <span class="keyword">by</span> <span class="string">','</span>;</span></code></pre>
<p>（table_sample 改为实际导入的表名）</p>
<p>— END —</p>
]]></content>
    <category scheme="http://itman.cc/tags/mysql/" term="mysql"/>
    <category scheme="http://itman.cc/categories/Database/" term="Database"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[智能路由：第一代极路由]]></title>
    <link href="http://itman.cc/2013/10/28/hiwifi-hc6361/"/>
    <id>http://itman.cc/2013/10/28/hiwifi-hc6361/</id>
    <published>2013-10-28T14:10:33.000Z</published>
    <updated>2013-11-03T15:09:59.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://farm3.staticflickr.com/2885/10647249776_32e5174bef_z.jpg" alt=""><br><a id="more"></a><br><img src="http://farm8.staticflickr.com/7366/10645862103_0fee1c02a5_z.jpg" alt=""><br><img src="http://farm8.staticflickr.com/7297/10645659916_5784d265de_z.jpg" alt=""><br><img src="http://farm8.staticflickr.com/7326/10647187705_075d4b863d_z.jpg" alt=""><br><img src="http://farm4.staticflickr.com/3714/10645657904_5a8f95cc64_z.jpg" alt=""><br><img src="http://farm6.staticflickr.com/5507/10645873613_8b8c1feca7_z.jpg" alt=""></p>
<p>随着第二代极路由发布会的逼近（11月6日），第一代极路￥99疯狂促销（原价￥199），特地抢了一台来体验一下。大概用了一周左右时间才到货。</p>
<ul>
<li>磨砂金属机身，用料上乘，无论是造工还是手感都不错，高端大气上档次</li>
<li>配置界面的交互和设计都比传统高几个档次，简单明了，估计能解决不少小白</li>
<li>插件是极路由的一大亮点<ul>
<li>手机远程管理：通过很简单的操作，即可绑定，用于远程查看和管理路由器，虽然日常作用不大，但可以为日后提供一个扩展的平台</li>
<li>屏蔽视频广告：随着现在视频网站播放广告的时间越来越长，这功能对于普通用户来说，不的不说“赞”，但同时也为视频网站广告部叫苦。如果国内的视频网站可以向youtube学习一下，也许我还是能接受广告的</li>
<li>[智能] 翻墙（大家懂的）：使用起来觉得不太给力，通过VPN或者超级SSH均或多或少地出现一些问题，最后不得不放弃。懂技术的，还是自己折腾好了。</li>
</ul>
</li>
<li>无线：即使开了 [穿墙模式] 但信号也没预期的好，与普通200块以内的差异不大；稳定性还不错，3天没重启都没问题（之前TP-LINK的24小时通电，基本每2天得重启）</li>
<li>USB供电：这只能说是一个噱头，除非极路由能把MODEM也集成在里头（这点我非常期望，毕竟桌面可以又少了一个设备），不然MODEM都断电了，路由器还有啥意义呢</li>
<li>保修：网站写着3年保修，但保修卡上只写1年，哪个为准？</li>
<li>吐槽：无USB接口，降低了扩展性；对于GEEK来说，无千兆网卡与双频WIFI也是一大遗憾。也许这也是第二代我们所期待的，回归到￥99抢购价，还是超值的！</li>
</ul>
<p>期待王总为我们带来第二代极路由！<br>p.s：第二代产品的发布，为每位到场的嘉宾（300人）提供￥1500的交通住宿报销，相当厚道！</p>
]]></content>
    <category scheme="http://itman.cc/tags/3c/" term="3c"/>
    <category scheme="http://itman.cc/tags/极路由/" term="极路由"/>
    <category scheme="http://itman.cc/tags/hiwifi/" term="hiwifi"/>
    <category scheme="http://itman.cc/categories/Geek/" term="Geek"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[Apple 免费大餐来了： Mavericks + iWork + iLife]]></title>
    <link href="http://itman.cc/2013/10/24/apple-free-mavericks-iwork-ilife/"/>
    <id>http://itman.cc/2013/10/24/apple-free-mavericks-iwork-ilife/</id>
    <published>2013-10-24T15:03:55.000Z</published>
    <updated>2013-11-06T04:53:40.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://farm4.staticflickr.com/3803/10647723563_1f2def4e0f_z.jpg" alt=""><br><a id="more"></a></p>
<p><img src="http://farm6.staticflickr.com/5502/10647494214_aa9391be14_z.jpg" alt=""><br><img src="http://farm3.staticflickr.com/2886/10647722163_bbe09b6e9d_z.jpg" alt=""></p>
<p>随着Mac OS X 10.9 Mavericks正式版的发布，将免费向用户提供。重拾旧路的原因也很简单：尽快普及，带动硬件销量的提升。伴随着一同免费到来的还有iWork &amp; iLife，日常个人办公软件。</p>
<p>这次的免费，无疑给微软带来一定的压力。最近半年，很多公司都被微软上门“追债”，今后大家看来可以建议老板们都购买苹果产品了 :)</p>
<h3>Mavericks 亮点：</h3>
<ul>
<li>重写底层：降低对硬件的消耗以及提高效率，这也是促进我升级最重要的原因</li>
<li>多屏显示的改进：多显一直是鸡肋，但这次打了个漂亮的翻身仗：（笔记本接外显）当合上笔记本盖子以后，机器并不会进入休眠模式，双屏的内容会自动融合到显示器上；当开启盖子后，自动切分还原。赞一个！</li>
<li>加入苹果地图：以后外出之前，可以先在笔记本上规划好路径，并自动同步到iPhone上</li>
<li>新的通知中心：系统在睡眠状态下也可以接收通知消息<br>……</li>
</ul>
<h3>吐槽：</h3>
<ul>
<li>homebrew 对新系统的支持还不是特别完善，重度依赖的同学请慎重</li>
</ul>
]]></content>
    <category scheme="http://itman.cc/tags/apple/" term="apple"/>
    <category scheme="http://itman.cc/tags/mavericks/" term="mavericks"/>
    <category scheme="http://itman.cc/categories/Geek/" term="Geek"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[小米电视首发开箱]]></title>
    <link href="http://itman.cc/2013/10/17/xiaomi-tv/"/>
    <id>http://itman.cc/2013/10/17/xiaomi-tv/</id>
    <published>2013-10-17T13:17:38.000Z</published>
    <updated>2013-11-05T00:33:06.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://farm3.staticflickr.com/2814/10645266626_cda43a57e8_z.jpg" alt=""></p>
<p><a id="more"></a><br><img src="http://farm6.staticflickr.com/5511/10645095565_376a71111e_z.jpg" alt=""><br><img src="http://farm4.staticflickr.com/3777/10645116264_48c000037c_z.jpg" alt=""><br><img src="http://farm4.staticflickr.com/3695/10645133696_387605a3e5_z.jpg" alt=""></p>
<h3>开箱首批小米电视。</h3>
<p>这次改用顺丰物流，客服说需要大概周日才派送，结果周四就到货，前后只用了三天，相比过往要等一个星期，实在是一个提升。</p>
<ul>
<li>第一感觉，47寸屏幕，大！（乐视S50在途，期待后面能对比体验）</li>
<li>正面logo是触摸式电源开关</li>
<li>能流畅播放本地网络高清电影，而且智能下载字幕（后补3D片体验）</li>
<li>系统基本功能与小米盒子一致</li>
<li>吐槽：前面板缝隙较大且不均。另外缺少摄像头，可扩展性也受限。</li>
</ul>
<p>总体而言，一台 47寸电视 + 小米盒子 = ￥2999，是相当有竞争力的。小米公司再次利用自身的核心价值（高性价比）搅局电视行业，期待传统电视厂商的反击！同时，我们也期待小米公司早日进入房地产行业 :)</p>
<p><br /></p>
<h4>配置：</h4>
<ul>
<li>LG屏（47英寸）与三星屏（48英寸）（1920×1080(1080P)）</li>
<li>高通骁龙 600 MPQ8064(四核1.7GHz)</li>
<li>2GB 双通道 DDR3；8GB eMMC高速闪存</li>
<li>802.11a/b/g/n,支持2x2MIMO</li>
<li>Bluetool 4.0</li>
<li>偏振式3D成像</li>
</ul>
]]></content>
    <category scheme="http://itman.cc/tags/3c/" term="3c"/>
    <category scheme="http://itman.cc/tags/小米/" term="小米"/>
    <category scheme="http://itman.cc/categories/Geek/" term="Geek"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[红米初体验]]></title>
    <link href="http://itman.cc/2013/10/08/xiaomi-hongmi/"/>
    <id>http://itman.cc/2013/10/08/xiaomi-hongmi/</id>
    <published>2013-10-08T10:05:01.000Z</published>
    <updated>2013-11-03T15:08:56.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://farm6.staticflickr.com/5497/10642709376_e47621d497_z.jpg" alt=""><br><a id="more"></a><br><img src="http://farm3.staticflickr.com/2847/10642623914_3a917d7ab7_z.jpg" alt=""><br><img src="http://farm6.staticflickr.com/5503/10642603725_99d9f12dab_z.jpg" alt=""><br><img src="http://farm6.staticflickr.com/5543/10642640196_5f59af2368_z.jpg" alt=""><br><img src="http://farm8.staticflickr.com/7397/10642633394_2138cd0a96_z.jpg" alt=""><br><img src="http://farm4.staticflickr.com/3812/10642856183_56af84a839_z.jpg" alt=""><br><img src="http://farm3.staticflickr.com/2870/10642642564_8f7ecda64d_c.jpg" alt=""><br><img src="http://farm3.staticflickr.com/2892/10642621695_2b9ca75cc3_z.jpg" alt=""></p>
<h3>红米初体验</h3>
<ul>
<li>第一感觉4.7寸屏幕真够大，IPS屏色彩还原尚可</li>
<li>后盖磨砂手感不错，整机有点偏重</li>
<li>久违了的miui，5.0版本界面设计和交互体验进步蛮大，给红米加分不少</li>
<li>虽然CPU使用的是MTK 四核1.5GHz，但MIUI系统的流畅度还是没法与iOS抗衡，真心建议针对红米出一个简化版</li>
<li>相机凑合，请看最后一张样张（最后一张为5s）。</li>
<li>对于一款老人机来说，以上配置也足以</li>
<li>吐槽：耳机真是渣，真心不推荐购买。宁愿在appletuan买一个￥128元的earpods</li>
</ul>
<p>总而言之，￥799双卡双待无论是送父母，还是作为备用机，你都值得拥有～</p>
<p><img src="http://farm4.staticflickr.com/3812/10642856183_56af84a839_z.jpg" alt=""><br>贴膜真是一门技术活。3张小米的膜贴上后，在日常使用中都发现了走位现象。郁闷~</p>
]]></content>
    <category scheme="http://itman.cc/tags/3c/" term="3c"/>
    <category scheme="http://itman.cc/tags/小米/" term="小米"/>
    <category scheme="http://itman.cc/categories/Geek/" term="Geek"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[小米盒子2初体验]]></title>
    <link href="http://itman.cc/2013/09/30/xiaomi-box2/"/>
    <id>http://itman.cc/2013/09/30/xiaomi-box2/</id>
    <published>2013-09-30T09:36:51.000Z</published>
    <updated>2013-11-03T15:09:15.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://farm8.staticflickr.com/7301/10644084464_833d486fd5_z.jpg" alt=""><br><a id="more"></a><br><img src="http://farm3.staticflickr.com/2893/10642391173_af10e13dd5_z.jpg" alt=""><br><img src="http://farm6.staticflickr.com/5505/10642173384_4546706533_z.jpg" alt=""><br><img src="http://farm8.staticflickr.com/7315/10642150155_04d31dec45_z.jpg" alt=""></p>
<h4>新小米盒子开箱感受</h4>
<ul>
<li>主机手感和造工继续保持水准</li>
<li>新遥控器简洁了，但按键的反馈手感较差，造工稍微欠缺</li>
<li>连显示器得另外买音频线（淘宝￥25有交易）</li>
<li>蓝光体验区电影的画质不错，需6M带宽支持</li>
<li>最吐槽的是，里面的TVB电视剧没有粤语（后附解决方法）</li>
</ul>
<p>总体来说，￥299的定价在整个行业中只能说是中规中矩，跟小米其他产品线比起来，感觉缺乏核心价值（这也好解释，为什么小米盒子是相对其他小米产品容易抢道的）。</p>
<h4>[粤语问题] 解决篇</h4>
<ul>
<li>通过手机助手连接盒子</li>
<li>安装 [小米桌面]</li>
<li>然后就可以安装 [优酷TV] 等app</li>
<li>重启盒子后选择 [小米桌面]，进入桌面后点击 [优酷TV]，粤语视频就在你面前</li>
</ul>
<p>p.s：自从安装了 [小米桌面] 后，原声的桌面进入的时候经常崩溃，尚未解决，因为一般只用它来看优酷。 </p>
<h4>附：配置</h4>
<ul>
<li>处理器：Cortext-A9, 1.5GHz（双核）</li>
<li>内存：1GB DDR3-1066 SDRAM</li>
<li>接口：可通过OTG线连U盘或移动硬盘；Micro-USB；</li>
<li>网络：RJ45 10M/100M；802.11b/g，支持2.4GHz/5GHz（双频）</li>
</ul>
]]></content>
    <category scheme="http://itman.cc/tags/3c/" term="3c"/>
    <category scheme="http://itman.cc/tags/小米/" term="小米"/>
    <category scheme="http://itman.cc/categories/Geek/" term="Geek"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[Apple iPhone5s 初体验]]></title>
    <link href="http://itman.cc/2013/09/25/apple-iphone5s/"/>
    <id>http://itman.cc/2013/09/25/apple-iphone5s/</id>
    <published>2013-09-25T12:05:51.000Z</published>
    <updated>2013-11-03T15:07:56.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://farm6.staticflickr.com/5544/10644285865_abc2edddf0_z.jpg" alt=""><br><a id="more"></a><br><img src="http://farm8.staticflickr.com/7315/10643548744_340d720250_z.jpg" alt=""><br><img src="http://farm4.staticflickr.com/3728/10643771833_e60355b4df_z.jpg" alt=""><br><img src="http://farm6.staticflickr.com/5498/10643774403_54a9c5c018_z.jpg" alt=""></p>
<h3>4s vs 5s:</h3>
<h4>亮点：</h4>
<ul>
<li>用完5s的屏幕回去看4s的，真又点小</li>
<li>指纹体验太棒了，基本上识别率95%以上</li>
</ul>
<h4>吐槽：</h4>
<ul>
<li>上手感觉轻太多了，不太习惯</li>
<li>为了解决黑色掉漆问题，背面颜色也换了，不如iPhone5的好看</li>
<li>陀螺仪BUG（最终在iOS 7.0.3中得到解决）</li>
</ul>
<p>p.s：联通套餐送的礼品还真不少</p>
]]></content>
    <category scheme="http://itman.cc/tags/3c/" term="3c"/>
    <category scheme="http://itman.cc/tags/apple/" term="apple"/>
    <category scheme="http://itman.cc/tags/iPhone/" term="iPhone"/>
    <category scheme="http://itman.cc/categories/Geek/" term="Geek"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[Chrome各版本下载集合]]></title>
    <link href="http://itman.cc/2013/09/11/chrome-download/"/>
    <id>http://itman.cc/2013/09/11/chrome-download/</id>
    <published>2013-09-11T13:03:16.000Z</published>
    <updated>2013-11-03T12:24:05.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://farm8.staticflickr.com/7419/10591121975_345d1b93d5_q.jpg" alt=""></p>
<h3>Windows平台：</h3>
<ul>
<li><em>最新稳定版（Stable Channel）Chrome在线安装:</em> <a href="http://www.google.com/chrome/eula.html" target="_blank">【点击这里】</a></li>
<li><em>最新测试版（Beta Channel）Chrome在线安装：</em> <a href="http://www.google.com/chrome/eula.html?extra=betachannel" target="_blank">【点击这里】</a></li>
<li><em>最新开发版（Dev Channel）Chrome在线安装：</em> <a href="http://www.google.com/chrome/eula.html?extra=devchannel" target="_blank">【点击这里】</a></li>
<li><em>最新金丝雀版（Canary build）Chrome在线安装：</em> <a href="http://tools.google.com/dlpage/chromesxs" target="_blank">【点击这里】</a>（new）</li>
<li><em>最新Chromium下载地址:</em> <a href="http://build.chromium.org/buildbot/snapshots/chromium-rel-xp/?O=D" target="_blank">【点击这里】</a></li>
</ul>
<p><a id="more"></a><br>附离线版Chrome下载方法：</p>
<pre><code><span class="label">http:</span>//dl<span class="preprocessor">.google</span><span class="preprocessor">.com</span>/chrome/install/[版本号后两位]/chrome_installer<span class="preprocessor">.exe</span></code></pre>
<p>也就是说要想下载离线版Chrome，必须要知道你要下载的版本号，取版本号第二个小数点的数字。比如4.0.266.0的下载地址就是：<br><a href="http://dl.google.com/chrome/install/266.0/chrome_installer.exe" target="_blank">http://dl.google.com/chrome/install/266.0/chrome_installer.exe</a></p>
<p>同理比如3.0.195.38的下载地址就是：<br><a href="http://dl.google.com/chrome/install/195.38/chrome_installer.exe" target="_blank">http://dl.google.com/chrome/install/195.38/chrome_installer.exe</a></p>
<p>注：离线版Chrome可能不会自动更新。</p>
<h3>Linux平台：</h3>
<ul>
<li><em>最新稳定版（Stable Channel）Chrome在线安装:</em> <a href="http://www.google.com/chrome/eula.html" target="_blank">【点击这里】</a></li>
<li><em>最新测试版（Beta Channel）Chrome在线安装：</em> <a href="http://www.google.com/intl/en/landing/chrome/beta/" target="_blank">【点击这里】</a></li>
<li><em>最新开发版（Dev Channel）Chrome在线安装(32bit)：</em> <a href="http://www.google.com/chrome/intl/en/eula_dev.html?dl=unstable_i386_deb" target="_blank">【点击这里】</a></li>
<li><em>最新开发版（Dev Channel）Chrome在线安装(64bit)：</em> <a href="http://www.google.com/chrome/intl/en/eula_dev.html?dl=unstable_amd64_deb" target="_blank">【点击这里】</a></li>
<li><em>最新Chromium下载地址(32bit):</em> <a href="http://build.chromium.org/buildbot/snapshots/chromium-rel-linux/?C=M;O=D" target="_blank">【点击这里】</a></li>
<li><em>最新Chromium下载地址(64bit):</em> <a href="http://build.chromium.org/buildbot/snapshots/chromium-rel-linux-64/?C=M;O=D" target="_blank">【点击这里】</a></li>
</ul>
<h3>Mac OS平台：</h3>
<ul>
<li><em>最新稳定版（Stable Channel）Chrome在线安装:</em> <a href="http://www.google.com/chrome/eula.html" target="_blank">【点击这里】</a></li>
<li><em>最新测试版（Beta Channel）Chrome在线安装：</em> <a href="http://www.google.com/intl/en/landing/chrome/beta/" target="_blank">【点击这里】</a></li>
<li><em>最新开发版（Dev Channel）Chrome在线安装：</em> <a href="http://www.google.com/chrome/intl/en/eula_dev.html?dl=mac" target="_blank">【点击这里】</a></li>
<li><em>最新Chromium下载地址:</em> <a href="http://build.chromium.org/buildbot/snapshots/chromium-rel-mac/?C=M;O=D" target="_blank">【点击这里】</a></li>
</ul>
]]></content>
    <category scheme="http://itman.cc/tags/chrome/" term="chrome"/>
    <category scheme="http://itman.cc/categories/News/" term="News"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[CentOS5 搭建L2TP VPN]]></title>
    <link href="http://itman.cc/2013/09/04/centos5-setup-l2tp/"/>
    <id>http://itman.cc/2013/09/04/centos5-setup-l2tp/</id>
    <published>2013-09-04T01:34:11.000Z</published>
    <updated>2013-11-06T04:57:19.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://farm8.staticflickr.com/7332/10601376594_b2d087a729_q.jpg" alt=""><br><a id="more"></a></p>
<figure class="highlight lang-shell"><figcaption><span>一键搭建L2TP脚本</span><a href="/upload/l2tp.sh">Download</a></figcaption><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
</pre></td><td class="code"><pre>    #!/bin/bash

    if [ $(id -u) != "0" ]; then
    printf "Error: You must be root to run this tool!\n"
    exit 1
    fi
    clear
    printf "
    ####################################################
    #                                                  #
    # This is a Shell-Based tool of l2tp installation  #
    #                                                  #
    ####################################################
    "
    vpsip=`ifconfig  | grep 'inet addr:'| grep -v '127.0.0.1' | cut -d: -f2 | awk 'NR==1 { print $1}'`

    iprange="10.0.99"
    echo "Please input IP-Range:"
    read -p "(Default Range: 10.0.99):" iprange
    if [ "$iprange" = "" ]; then
    iprange="10.0.99"
    fi

    mypsk="itman.cc"
    echo "Please input PSK:"
    read -p "(Default PSK: itman.cc):" mypsk
    if [ "$mypsk" = "" ]; then
    mypsk="itman.cc"
    fi

    clear
    get_char()
    {
    SAVEDSTTY=`stty -g`
    stty -echo
    stty cbreak
    dd if=/dev/tty bs=1 count=1 2&gt; /dev/null
    stty -raw
    stty echo
    stty $SAVEDSTTY
    }
    echo ""
    echo "ServerIP:"
    echo "$vpsip"
    echo ""
    echo "Server Local IP:"
    echo "$iprange.1"
    echo ""
    echo "Client Remote IP Range:"
    echo "$iprange.2-$iprange.254"
    echo ""
    echo "PSK:"
    echo "$mypsk"
    echo ""
    echo "Press any key to start..."
    char=`get_char`
    clear

    apt-get -y update
    apt-get -y upgrade
    apt-get -y install libgmp3-dev bison flex libpcap-dev ppp iptables make gcc lsof vim
    mkdir /ztmp
    mkdir /ztmp/l2tp
    cd /ztmp/l2tp
    wget http://www.openswan.org/download/openswan-2.6.24.tar.gz
    tar zxvf openswan-2.6.24.tar.gz
    cd openswan-2.6.24
    make programs install
    rm -rf /etc/ipsec.conf
    touch /etc/ipsec.conf
    cat &gt;&gt;/etc/ipsec.conf<span class="tag">&lt;<span class="title">&lt;EOF
</span>    <span class="attribute">config</span> <span class="attribute">setup</span>
    <span class="attribute">nat_traversal</span>=<span class="value">yes</span>
    <span class="attribute">virtual_private</span>=<span class="value">%v4:10.0.0.0</span>/<span class="attribute">8</span>,%<span class="attribute">v4:192.168.0.0</span>/<span class="attribute">16</span>,%<span class="attribute">v4:172.16.0.0</span>/<span class="attribute">12</span>
    <span class="attribute">oe</span>=<span class="value">off</span>
    <span class="attribute">protostack</span>=<span class="value">netkey</span>

    <span class="attribute">conn</span> <span class="attribute">L2TP-PSK-NAT</span>
    <span class="attribute">rightsubnet</span>=<span class="value">vhost:%priv</span>
    <span class="attribute">also</span>=<span class="value">L2TP-PSK-noNAT</span>

    <span class="attribute">conn</span> <span class="attribute">L2TP-PSK-noNAT</span>
    <span class="attribute">authby</span>=<span class="value">secret</span>
    <span class="attribute">pfs</span>=<span class="value">no</span>
    <span class="attribute">auto</span>=<span class="value">add</span>
    <span class="attribute">keyingtries</span>=<span class="value">3</span>
    <span class="attribute">rekey</span>=<span class="value">no</span>
    <span class="attribute">ikelifetime</span>=<span class="value">8h</span>
    <span class="attribute">keylife</span>=<span class="value">1h</span>
    <span class="attribute">type</span>=<span class="value">transport</span>
    <span class="attribute">left</span>=<span class="value">$vpsip</span>
    <span class="attribute">leftprotoport</span>=<span class="value">17</span>/<span class="attribute">1701</span>
    <span class="attribute">right</span>=<span class="value">%any</span>
    <span class="attribute">rightprotoport</span>=<span class="value">17</span>/%<span class="attribute">any</span>
    <span class="attribute">EOF</span>
    <span class="attribute">cat</span> &gt;</span>&gt;/etc/ipsec.secrets<span class="tag">&lt;<span class="title">&lt;EOF
</span>    $<span class="attribute">vpsip</span> %<span class="attribute">any:</span> <span class="attribute">PSK</span> "$<span class="attribute">mypsk</span>"
    <span class="attribute">EOF</span>
    <span class="attribute">sed</span> <span class="attribute">-i</span> '<span class="attribute">s</span>/#<span class="attribute">net.ipv4.ip_forward</span>=<span class="value">1</span>/<span class="attribute">net.ipv4.ip_forward</span>=<span class="value">1</span>/<span class="attribute">g</span>' /<span class="attribute">etc</span>/<span class="attribute">sysctl.conf</span>
    <span class="attribute">sed</span> <span class="attribute">-i</span> '<span class="attribute">s</span>/#<span class="attribute">net.ipv6.conf.all.forwarding</span>=<span class="value">1</span>/<span class="attribute">net.ipv6.conf.all.forwarding</span>=<span class="value">1</span>/<span class="attribute">g</span>' /<span class="attribute">etc</span>/<span class="attribute">sysctl.conf</span>
    <span class="attribute">sysctl</span> <span class="attribute">-p</span>
    <span class="attribute">iptables</span> <span class="attribute">--table</span> <span class="attribute">nat</span> <span class="attribute">--append</span> <span class="attribute">POSTROUTING</span> <span class="attribute">--jump</span> <span class="attribute">MASQUERADE</span>
    <span class="attribute">for</span> <span class="attribute">each</span> <span class="attribute">in</span> /<span class="attribute">proc</span>/<span class="attribute">sys</span>/<span class="attribute">net</span>/<span class="attribute">ipv4</span>/<span class="attribute">conf</span>/*
    <span class="attribute">do</span>
    <span class="attribute">echo</span> <span class="attribute">0</span> &gt;</span> $each/accept_redirects
    echo 0 &gt; $each/send_redirects
    done
    /etc/init.d/ipsec restart
    ipsec verify
    cd /ztmp/l2tp
    wget http://nchc.dl.sourceforge.net/project/rp-l2tp/rp-l2tp/0.4/rp-l2tp-0.4.tar.gz
    tar zxvf rp-l2tp-0.4.tar.gz
    cd rp-l2tp-0.4
    ./configure
    make
    cp handlers/l2tp-control /usr/local/sbin/
    mkdir /var/run/xl2tpd/
    ln -s /usr/local/sbin/l2tp-control /var/run/xl2tpd/l2tp-control
    cd /ztmp/l2tp
    wget http://www.xelerance.com/wp-content/uploads/software/xl2tpd/xl2tpd-1.2.8.tar.gz
    tar zxvf xl2tpd-1.2.8.tar.gz
    cd xl2tpd-1.2.8
    make install
    mkdir /etc/xl2tpd
    rm -rf /etc/xl2tpd/xl2tpd.conf
    touch /etc/xl2tpd/xl2tpd.conf
    cat &gt;&gt;/etc/xl2tpd/xl2tpd.conf<span class="tag">&lt;<span class="title">&lt;EOF
</span>    [<span class="attribute">global</span>]
    <span class="attribute">ipsec</span> <span class="attribute">saref</span> = <span class="attribute">yes</span>
    [<span class="attribute">lns</span> <span class="attribute">default</span>]
    <span class="attribute">ip</span> <span class="attribute">range</span> = $<span class="attribute">iprange.2-</span>$<span class="attribute">iprange.254</span>
    <span class="attribute">local</span> <span class="attribute">ip</span> = $<span class="attribute">iprange.1</span>
    <span class="attribute">refuse</span> <span class="attribute">chap</span> = <span class="attribute">yes</span>
    <span class="attribute">refuse</span> <span class="attribute">pap</span> = <span class="attribute">yes</span>
    <span class="attribute">require</span> <span class="attribute">authentication</span> = <span class="attribute">yes</span>
    <span class="attribute">ppp</span> <span class="attribute">debug</span> = <span class="attribute">yes</span>
    <span class="attribute">pppoptfile</span> = /<span class="attribute">etc</span>/<span class="attribute">ppp</span>/<span class="attribute">options.xl2tpd</span>
    <span class="attribute">length</span> <span class="attribute">bit</span> = <span class="attribute">yes</span>
    <span class="attribute">EOF</span>
    <span class="attribute">rm</span> <span class="attribute">-rf</span> /<span class="attribute">etc</span>/<span class="attribute">ppp</span>/<span class="attribute">options.xl2tpd</span>
    <span class="attribute">touch</span> /<span class="attribute">etc</span>/<span class="attribute">ppp</span>/<span class="attribute">options.xl2tpd</span>
    <span class="attribute">cat</span> &gt;</span>&gt;/etc/ppp/options.xl2tpd<span class="tag">&lt;<span class="title">&lt;EOF
</span>    <span class="attribute">require-mschap-v2</span>
    <span class="attribute">ms-dns</span> <span class="attribute">8.8.8.8</span>
    <span class="attribute">ms-dns</span> <span class="attribute">8.8.4.4</span>
    <span class="attribute">asyncmap</span> <span class="attribute">0</span>
    <span class="attribute">auth</span>
    <span class="attribute">crtscts</span>
    <span class="attribute">lock</span>
    <span class="attribute">hide-password</span>
    <span class="attribute">modem</span>
    <span class="attribute">debug</span>
    <span class="attribute">name</span> <span class="attribute">l2tpd</span>
    <span class="attribute">proxyarp</span>
    <span class="attribute">lcp-echo-interval</span> <span class="attribute">30</span>
    <span class="attribute">lcp-echo-failure</span> <span class="attribute">4</span>
    <span class="attribute">EOF</span>
    <span class="attribute">cat</span> &gt;</span>&gt;/etc/ppp/chap-secrets<span class="tag">&lt;<span class="title">&lt;EOF
</span>    <span class="attribute">test</span> <span class="attribute">l2tpd</span> <span class="attribute">test123</span> *
    <span class="attribute">EOF</span>
    <span class="attribute">touch</span> /<span class="attribute">usr</span>/<span class="attribute">bin</span>/<span class="attribute">zl2tpset</span>
    <span class="attribute">echo</span> "#/<span class="attribute">bin</span>/<span class="attribute">bash</span>" &gt;</span>&gt;/usr/bin/zl2tpset
    echo "for each in /proc/sys/net/ipv4/conf/*" &gt;&gt;/usr/bin/zl2tpset
    echo "do" &gt;&gt;/usr/bin/zl2tpset
    echo "echo 0 &gt; \$each/accept_redirects" &gt;&gt;/usr/bin/zl2tpset
    echo "echo 0 &gt; \$each/send_redirects" &gt;&gt;/usr/bin/zl2tpset
    echo "done" &gt;&gt;/usr/bin/zl2tpset
    chmod +x /usr/bin/zl2tpset
    iptables --table nat --append POSTROUTING --jump MASQUERADE
    zl2tpset
    xl2tpd
    cat &gt;&gt;/etc/rc.local<span class="tag">&lt;<span class="title">&lt;EOF
</span>    <span class="attribute">iptables</span> <span class="attribute">--table</span> <span class="attribute">nat</span> <span class="attribute">--append</span> <span class="attribute">POSTROUTING</span> <span class="attribute">--jump</span> <span class="attribute">MASQUERADE</span>
    /<span class="attribute">etc</span>/<span class="attribute">init.d</span>/<span class="attribute">ipsec</span> <span class="attribute">restart</span>
    /<span class="attribute">usr</span>/<span class="attribute">bin</span>/<span class="attribute">zl2tpset</span>
    /<span class="attribute">usr</span>/<span class="attribute">local</span>/<span class="attribute">sbin</span>/<span class="attribute">xl2tpd</span>
    <span class="attribute">EOF</span>
    <span class="attribute">clear</span>
    <span class="attribute">ipsec</span> <span class="attribute">verify</span>
    <span class="attribute">printf</span> "
    ####################################################
    #                                                  #
    # <span class="attribute">This</span> <span class="attribute">is</span> <span class="attribute">a</span> <span class="attribute">Shell-Based</span> <span class="attribute">tool</span> <span class="attribute">of</span> <span class="attribute">l2tp</span> <span class="attribute">installation</span>  #
    #                                                  #
    ####################################################
    <span class="attribute">if</span> <span class="attribute">there</span> <span class="attribute">are</span> <span class="attribute">no</span> [<span class="attribute">FAILED</span>] <span class="attribute">above</span>, <span class="attribute">then</span> <span class="attribute">you</span> <span class="attribute">can</span>
    <span class="attribute">connect</span> <span class="attribute">to</span> <span class="attribute">your</span> <span class="attribute">L2TP</span> <span class="attribute">VPN</span> <span class="attribute">Server</span> <span class="attribute">with</span> <span class="attribute">the</span> <span class="attribute">default</span>
    <span class="attribute">user</span>/<span class="attribute">pass</span> <span class="attribute">below:</span>

    <span class="attribute">ServerIP:</span>$<span class="attribute">vpsip</span>
    <span class="attribute">username:test</span>
    <span class="attribute">password:test123</span>
    <span class="attribute">PSK:</span>$<span class="attribute">mypsk</span>

    "
</pre></td></tr></table></figure>

]]></content>
    <category scheme="http://itman.cc/tags/l2tp/" term="l2tp"/>
    <category scheme="http://itman.cc/tags/vpn/" term="vpn"/>
    <category scheme="http://itman.cc/categories/Unix/Linux/" term="Unix/Linux"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[CentOS PHP 5.2.x 链接Oracle数据库]]></title>
    <link href="http://itman.cc/2013/09/03/centos-php-5-2-connect-to-oracle/"/>
    <id>http://itman.cc/2013/09/03/centos-php-5-2-connect-to-oracle/</id>
    <published>2013-09-03T03:31:20.000Z</published>
    <updated>2013-11-06T04:57:31.000Z</updated>
    <content type="html"><![CDATA[<p>1、下载Oracle即时客户端程序包 — Basic： 运行 OCI、OCCI 和 JDBC-OCI 应用程序所需的所有文件</p>
<p>①、打开以下网址（本文以32位版为例）：<br><a href="http://www.oracle.com/technetwork/topics/linuxsoft-082809.html" target="_blank">http://www.oracle.com/technetwork/topics/linuxsoft-082809.html</a></p>
<p>②、下载以下几个文件：<br>oracle-instantclient11.2-basic-11.2.0.2.0.i386.rpm<br>oracle-instantclient11.2-devel-11.2.0.2.0.i386.rpm<br>oracle-instantclient11.2-sqlplus-11.2.0.2.0.i386.rpm</p>
<p>2、安装Oracle即时客户端程序包</p>
<pre><code>rpm -ivh oracle-instantclient11<span class="number">.2</span>-basic-<span class="number">11.2</span><span class="number">.0</span><span class="number">.2</span><span class="number">.0</span><span class="preprocessor">.i</span>386<span class="preprocessor">.rpm</span> oracle-instantclient11<span class="number">.2</span>-devel-<span class="number">11.2</span><span class="number">.0</span><span class="number">.2</span><span class="number">.0</span><span class="preprocessor">.i</span>386<span class="preprocessor">.rpm</span> oracle-instantclient11<span class="number">.2</span>-sqlplus-<span class="number">11.2</span><span class="number">.0</span><span class="number">.2</span><span class="number">.0</span><span class="preprocessor">.i</span>386<span class="preprocessor">.rpm</span>
echo <span class="string">"/usr/lib/oracle/11.1/client/lib/"</span> &gt; /etc/<span class="keyword">ld</span><span class="preprocessor">.so</span><span class="preprocessor">.conf</span><span class="preprocessor">.d</span>/oracle_client<span class="preprocessor">.conf</span>
/sbin/ldconfig</code></pre>
<p>3、安装OCI8 PHP扩展（使用PHP自带的OCI8，假设PHP程序安装在/usr/local/webserver/php/）</p>
<pre><code><span class="title">yum</span> install libaio
<span class="title">wget</span> http://pecl.php.net/get/oci8-<span class="number">1.4</span><span class="number">.4</span>.tgz
<span class="title">cd</span> oci8-<span class="number">1.4</span><span class="number">.4</span>/
/usr/local/webserver/php/bin/phpize <span class="type">CFLAGS</span>=<span class="string">"-I/usr/include/oracle/11.2/client/"</span> <span class="type">CXXFLAGS</span>=<span class="string">"-I/usr/include/oracle/11.2/client/"</span>
./configure <span class="comment">--with-php-config=/usr/local/webserver/php/bin/php-config --with-oci8=/usr/lib/oracle/11.2/client/</span>
<span class="title">make</span>
<span class="title">make</span> install</code></pre>
<p>make oci8出错的话，用这个编译试试</p>
<pre><code>.<span class="regexp">/configure --with-php-config=/usr</span><span class="regexp">/local/webserver</span><span class="regexp">/php/bin</span><span class="regexp">/php-config --with-oci8=instantclient,/usr</span><span class="regexp">/lib/oracle</span><span class="regexp">/11.2/client</span><span class="regexp">/lib/</span></code></pre>
<p>4、修改PHP配置文件（/usr/local/webserver/php/etc/php.ini）<br>在extension_dir = “/usr/local/webserver/php/lib/php/extensions/no-debug-non-zts-20060613/”后增加一行：</p>
<pre><code><span class="setting">extension = <span class="value"><span class="string">"oci8.so"</span></span></span></code></pre>
<p>5、重启PHP</p>
<p>6、创建一个phpinfo.php文件（内容如下）并通过Web访问，如果有“oci8”这一项，则表明安装成功。</p>
<pre><code><span class="preprocessor">&lt;?php</span>
phpinfo();
<span class="preprocessor">?&gt;</span></code></pre>
]]></content>
    <category scheme="http://itman.cc/tags/oracle/" term="oracle"/>
    <category scheme="http://itman.cc/tags/centos/" term="centos"/>
    <category scheme="http://itman.cc/tags/php/" term="php"/>
    <category scheme="http://itman.cc/categories/Unix/Linux/" term="Unix/Linux"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[MsSQL 64位配置方法]]></title>
    <link href="http://itman.cc/2013/09/02/mssql-64bit-configuration/"/>
    <id>http://itman.cc/2013/09/02/mssql-64bit-configuration/</id>
    <published>2013-09-02T15:12:46.000Z</published>
    <updated>2013-11-05T00:00:32.000Z</updated>
    <content type="html"><![CDATA[<p>新搭建一台R710，CPU XEON 5520再搭配16G内存，使用起来应该还蛮爽的说~~~以为装起来应该很顺利，但发现每次系统总是N多东西需要配置。</p>
<p>1、安装WINDOWS2003 64位 + SP</p>
<p>2、安装MsSQL 2005 64位 + SP</p>
<p>3、配置环境：<br>1）新建SqlServer用户；<br>2）使用SqlServer运行SqlServer以及SqlAgent服务；<br>3）至此，以为系统就已经配置成功了，但SqlAgent老是无法启动，提示错误如下：</p>
<p>SQLServerAgent could not be started (reason: SQLServerAgent 必须能够以 SysAdmin 身份连接到 SQLServer，但“(未知)”不是 SysAdmin 角色的成员)。<br>SQL Server 阻止了对组件 ‘Agent XPs’ 的 过程’dbo.sp_sqlagent_get_startup_info’ 的访问，因为此组件已作为此服务器安全配置的一部分而被关闭。系统管理员可以通过使用 sp_configure 启用 ‘Agent XPs’。有关启用 ‘Agent XPs’ 的详细信息，请参阅 SQL Server 联机丛书中的 “外围应用配置器”。<br>原来漏掉了内存分配权限，如图：<br><img src="http://farm8.staticflickr.com/7430/10627448863_767c77bfb3_o.jpg" alt=""></p>
]]></content>
    <category scheme="http://itman.cc/tags/mssql/" term="mssql"/>
    <category scheme="http://itman.cc/categories/Database/" term="Database"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[MsSQL 2005 数据库镜像的搭建与维护]]></title>
    <link href="http://itman.cc/2013/09/02/mssql-2005-setup-mirror/"/>
    <id>http://itman.cc/2013/09/02/mssql-2005-setup-mirror/</id>
    <published>2013-09-02T15:02:27.000Z</published>
    <updated>2013-11-04T23:58:13.000Z</updated>
    <content type="html"><![CDATA[<p>数据库镜像大大提高了可用性，并为故障转移群集或日志传送提供了一种易于管理的替代方案或补充方案。同步数据库镜像会话时，数据库镜像提供了热备用服务器，可支持在已提交事务不丢失数据的情况下进行快速故障转移。在一般的镜像会话期间，如果生产服务器出现故障，客户端应用程序可以通过重新连接到备用服务器来快速进行恢复。<br><a id="more"></a></p>
<h3>一、准备工作</h3>
<h4>(一) 安装三个实例,分别为:</h4>
<p>SZDXBAK\SQLSERVER(默认实例), 作为主体服务器<br>SZDXBAK\SQL2 作为镜像服务器<br>SZDXBAK\WITNESS 作为鉴证服务器<br>注: 所有实例服务使用SQLService账户启动</p>
<h4>(二) 数据库准备</h4>
<p>1、在主体服务上创建测试数据库 RecoveryDb<br>并创建一个完全备份</p>
<p>2、在镜像服务上使用NORECOVERY选项恢复数据库,<br>恢复后数据库状态为’正在还原’</p>
<h3>二、创建数据库镜像端点</h3>
<p>1、在主体数据库(SQLSERVER实例)上创建端点,用于伙伴通讯</p>
<pre><code><span class="operator"><span class="keyword">CREATE</span> ENDPOINT DbMirroring
 STATE=STARTED
 <span class="keyword">AS</span> TCP(LISTENER_PORT=<span class="number">5022</span>)
 <span class="keyword">FOR</span> DATABASE_MIRRORING(ROLE=PARTNER,ENCRYPTION=SUPPORTED)
<span class="keyword">GO</span></code></pre>
<p>2、在镜像数据库(SQL2实例)上创建端点,用于伙伴通讯</p>
<pre><code><span class="operator"><span class="keyword">CREATE</span> ENDPOINT DbMirroring
 STATE=STARTED
 <span class="keyword">AS</span> TCP(LISTENER_PORT=<span class="number">5033</span>)
 <span class="keyword">FOR</span> DATABASE_MIRRORING(ROLE=PARTNER,ENCRYPTION=SUPPORTED)
<span class="keyword">GO</span></code></pre>
<p>3、在鉴证服务器(WITNESS实例)上创建端点,用于鉴证通讯</p>
<pre><code><span class="operator"><span class="keyword">CREATE</span> ENDPOINT DbMirroring
 STATE=STARTED
 <span class="keyword">AS</span> TCP(LISTENER_PORT=<span class="number">5022</span>)
 <span class="keyword">FOR</span> DATABASE_MIRRORING(ROLE=WITNESS,ENCRYPTION=SUPPORTED)
<span class="keyword">GO</span>

<span class="keyword">ALTER</span> ENDPOINT DbMirroring STATE=STARTED
<span class="keyword">GO</span></code></pre>
<p>4、检查端点配置,可分别在不同服务器上运行以下查询</p>
<pre><code><span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> sys.database_mirroring_endpoints</code></pre>
<h3>三、配置数据库镜像安全性</h3>
<p>1、主体数据库(SQLSERVER实例)</p>
<pre><code>use master
go
<span class="operator"><span class="keyword">GRANT</span> <span class="keyword">CONNECT</span> <span class="keyword">ON</span> ENDPOINT::<span class="string">"DbMirroring"</span> <span class="keyword">TO</span> <span class="string">"SZDXBAK\SQLService"</span>
<span class="keyword">go</span></code></pre>
<p>2、镜像数据库(SQL2实例)</p>
<pre><code>use master
go
<span class="operator"><span class="keyword">GRANT</span> <span class="keyword">CONNECT</span> <span class="keyword">ON</span> ENDPOINT::<span class="string">"DbMirroring"</span> <span class="keyword">TO</span> <span class="string">"SZDXBAK\SQLService"</span>
<span class="keyword">go</span></code></pre>
<p>3、鉴证服务器(WITNESS实例)</p>
<pre><code>use master
go
<span class="operator"><span class="keyword">GRANT</span> <span class="keyword">CONNECT</span> <span class="keyword">ON</span> ENDPOINT::<span class="string">"DbMirroring"</span> <span class="keyword">TO</span> <span class="string">"SZDXBAK\SQLService"</span>
<span class="keyword">go</span></code></pre>
<h3>四、启动数据库镜像</h3>
<p>注意配置顺序<br>1、在镜像数据库(SQL2实例)上,指定到主体服务器(SQLSERVER实例)的伙伴端点</p>
<pre><code><span class="operator"><span class="keyword">ALTER</span> DATABASE RecoveryDb
<span class="keyword">SET</span> PARTNER=N<span class="string">'TCP://SZDXBAK:5022'</span>
<span class="keyword">go</span></code></pre>
<p>2、在主数据库(SQLSERVER实例)上,指定到镜像服务器(SQL2实例)的伙伴端点</p>
<pre><code><span class="operator"><span class="keyword">ALTER</span> DATABASE RecoveryDb
<span class="keyword">SET</span> PARTNER=N<span class="string">'TCP://SZDXBAK:5033'</span>
<span class="keyword">go</span></code></pre>
<p>注: 以上两步完成后,已经配置为高保护级别性模式</p>
<p>3、如果要创建高可用性模式:在主数据库上(SQLSERVER实例),指定鉴证服务器端点</p>
<pre><code><span class="operator"><span class="keyword">ALTER</span> DATABASE RecoveryDb
<span class="keyword">SET</span> WITNESS=N<span class="string">'TCP://SZDXBAK:5044'</span>
<span class="keyword">go</span></code></pre>
<p>4、在高可用性模式下:配置数据库镜像事务安全级别</p>
<pre><code><span class="operator"><span class="keyword">ALTER</span> DATABASE RecoveryDb <span class="keyword">SET</span> SAFETY <span class="keyword">FULL</span>
<span class="keyword">go</span></code></pre>
<h3>五、查看数据库镜像的配置状态</h3>
<p>1、通过Management Studio 对象资源管理器,查看主体数据库,镜像数据库状态<br>2、通过Management Studio 对象资源管理器中的数据库属性查看状态<br>3、通过系统目录视图查看数据库镜像配置情况</p>
<pre><code><span class="type">SELECT</span> * <span class="type">FROM</span> sys.<span class="typedef">database_mirroring_endpoints</span>
<span class="type">SELECT</span> * <span class="type">FROM</span> sys.<span class="typedef">database_mirroring_endpoints</span>
<span class="type">WHERE</span> <span class="typedef">database_id = <span class="container">(<span class="type">SELECT</span> <span class="title">database_id</span> <span class="type">FROM</span> <span class="title">sys</span>.<span class="title">database</span>
<span class="type">WHERE</span> <span class="title">name</span>='<span class="type">RecoveryDb</span>')</span></span></code></pre>
<p>以上配置完成后,主体数据库的状态为:主体,已同步<br>镜像数据库的状态为:镜像,已同步/正在还原..</p>
<h3>六、服务器角色切换测试</h3>
<p>预备知识<br>数据库镜像角色切换<br>自动故障转移<br>只针对高可用性模式<br>SAFETY=FULL<br>手动故障转移<br>针对高可用性模式和高保护级别性模式<br>SAFETY=FULL<br>强制服务<br>只针对高性能模式<br>SAFETY=OFF</p>
<h4>(一) 自动故障转移</h4>
<p>在主体服务器上,断开网络连接,通过数据库资源管理器查看主体/镜像服务器上数据库的状态</p>
<p>镜像服务器状态: 主体,已断开连接</p>
<p>恢复主体服务器</p>
<p>此时原来主体服务器(SQLSERVER实例)变为镜像服务器 状态为:镜像,已同步/正在还原..</p>
<p>原来镜像服务器(SQL2实例)变为主体服务器 状态:主体,已同步</p>
<h4>(二) 手动故障转移</h4>
<p>–主体服务器上执行故障转移过程</p>
<pre><code>USE MASTER
go
<span class="operator"><span class="keyword">ALTER</span> DATABASE RecoveryDb <span class="keyword">SET</span> PARTNER FAILOVER
<span class="keyword">go</span></code></pre>
<p>执行完后主体服务器状态变为: 镜像,已同步/正在还原..<br>镜像服务器状态变为 主体,已同步</p>
<h4>(三) 强制服务,有可能造成数据丢失</h4>
<p>1) 在镜像服务器上,取消对鉴证服务器的配置</p>
<pre><code><span class="operator"><span class="keyword">ALTER</span> DATABASE RecoveryDb <span class="keyword">SET</span> WINTESS OFF</code></pre>
<p>2) 在镜像服务器上,配置事务安全性为OFF</p>
<pre><code><span class="operator"><span class="keyword">ALTER</span> DATABASE RecoveryDb <span class="keyword">SET</span> SAFETY OFF</code></pre>
<p>3) 断开主体服务器,在镜像服务器上,强制服务 进行角色切换</p>
<pre><code><span class="operator"><span class="keyword">ALTER</span> DATABASE RecoveryDb <span class="keyword">SET</span> PARTNER FORCE_SERVICE_ALLOW_DATA_LOSS</code></pre>
<p>完成后数据库状态为 主体,已断开连接</p>
<h3>七、如何查询镜像服务器上的数据: 在镜像服务器上创建数据库快照</h3>
<p>1、在镜像服务器上,创建数据库快照</p>
<pre><code><span class="operator"><span class="keyword">CREATE</span> DATABASE ReconveryDb_snap_1
 <span class="keyword">ON</span> (NAME=RecoveryDb,FILENAM=<span class="string">'H:\seconddb\recovery_snap1.ss'</span>)
 <span class="keyword">AS</span> SNAPSHOT <span class="keyword">OF</span> RecoveryDb</code></pre>
<p>2、访问镜像数据库</p>
<pre><code>USE ReconveryDb_snap_1
go
<span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> test</code></pre>
<h3>八、镜像数据库之间的用户问题</h3>
<p>假设有镜像的服务器是MIR-A和MI-B，要访问镜像数据库的登录账号是tom，使用下面这个方法就可以在MIR-A上创建登录名tom，然后在镜像数据库中创建数据库用户tom并映射到登录名tom<br>执行下列语句取回tom的sid</p>
<pre><code><span class="operator"><span class="keyword">select</span> [name], sid <span class="keyword">from</span> syslogins <span class="keyword">where</span> [name] = <span class="string">'tom'</span></code></pre>
<p>—————————————————–<br>tom 0xD6AABCC8F83E3243A6C3C97F28A4CB55</p>
<p>然后在MIR-B上用下面的语句创建登录名tom</p>
<pre><code><span class="title">sp_addlogin</span> <span class="variable">@loginame</span> = <span class="string">'tom'</span>, <span class="variable">@passwd</span> = <span class="string">'password'</span>, <span class="variable">@sid</span> = 0xD6AABCC8F83E3243A6C3C97F28A4CB55</code></pre>
]]></content>
    <category scheme="http://itman.cc/tags/mssql/" term="mssql"/>
    <category scheme="http://itman.cc/categories/Database/" term="Database"/>
  </entry>
  <entry>
    <title type="html"><![CDATA[MsSQL 备份文件还原后引起的孤立用户解决方法]]></title>
    <link href="http://itman.cc/2013/09/02/mssql-change-users-login/"/>
    <id>http://itman.cc/2013/09/02/mssql-change-users-login/</id>
    <published>2013-09-02T14:52:03.000Z</published>
    <updated>2013-11-05T00:00:47.000Z</updated>
    <content type="html"><![CDATA[<p>很多用户使用的是远程的SQL服务器，数据库备份后都备份在远程服务器中，如果要将数据转存到本地SQL服务器的话，就会使用到强制还原。这样就会产生孤立用户，对于SQL SERVER2000中需要在数据库中执行以下查询，就可以删除。</p>
<pre><code><span class="title">exec</span> sp_change_users_login <span class="string">'update_one'</span>,<span class="string">'没有登陆名的数据库用户'</span>, <span class="string">'新的登陆名'</span></code></pre>
<p>但由于SQL SERVER 2005采用了架构，所以在删除用户是会出现一些错误，因此在这里把我在强制还原后的一些处理方法介绍给大家以作参照。</p>
<ul>
<li>适用于远程服务器数据库备份后，下载到本地并在本地SQL服务器上还原引的狐立用户问题；</li>
<li>仅适用于SQLSERVER 2005 或以上版本；</li>
</ul>
]]></content>
    <category scheme="http://itman.cc/tags/mssql/" term="mssql"/>
    <category scheme="http://itman.cc/categories/Database/" term="Database"/>
  </entry>
</feed>
